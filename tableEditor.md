Base SAS: Creating a Data Grid Like VB.NET | SAS Support           

Creating a Data Grid Like VB.NET
--------------------------------

Chevell Parker, SAS Institute

* * *

Introduction
------------

Tableeditor.tpl is a custom tagset that is created by the TEMPLATE procedure. The tableeditor tagset uses HTML, CSS, JavaScript, and the Markup language. You can download the tableeditor.tpl file and examples as a ZIP file . The tableeditor tagset enables you to create HTML output with function enhanced functionality driven using options. You can easily export the output to Excel pivot tables on Windows. See the additional resource listed below.  
[Using SAS to add PivotTables to your Excel workbook - SAS Users](https://blogs.sas.com/content/sgf/2015/03/27/using-sas-to-add-pivottables-to-your-excel-workbook/)

* * *

Colors
------

You can modify colors of your output in the following ways: Alternating row colors can be specified by using the BANNER\_COLOR\_EVEN= and BANNER\_COLOR\_ODD= options. Alternating columns can be generated by using the COL\_COLOR\_EVEN= and COL\_COLOR\_ODD= options. The FBANNER\_COLOR\_EVEN= and FBANNER\_COLOR\_ODD= options specify foreground colors for alternate rows. The background color of the body of the table can be specified with the BACKGROUND\_COLOR= option. The scrollbar can be specified using the SCROLLBAR\_COLOR= option. A mouseover color can be specified using the HIGHLIGHT\_COLOR= option. The header background color can be specified using the HEADER\_BCOLOR= option. Gridline colors can be modified using the GRIDLINE\_COLOR= option and can be removed using the GRIDLINE="NO" option and more.

ods tagsets.tableeditor file="c:\\temp.html"
    options(banner\_color\_even="lightblue"
            banner\_color\_odd="pink");

proc print data=sashelp.class;
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

ods tagsets.tableeditor file="c:\\temp.html"
    style=styles.mystyle
    options(col\_color\_odd="pink"
            col\_color\_even="lightblue"
            banner\_color\_even="teal"
            fbanner\_color\_even="white"
            );

proc print data=sashelp.class;
  title "Alternating column and row colors";
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

ods tagsets.tableeditor file="c:\\combo.html"
    style=styles.mystyle
    options(banner\_color\_even="teal"
            fbanner\_color\_even="white"
            col\_color\_even="lightpink"
            col\_color\_odd="lightblue"
            scrollbar\_color="teal"
            background\_color="brown"
            );

proc print data=sashelp.class(obs=10);
  title c=white " Combination of color options";
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Images or Logos
---------------

Images or logos can be applied by using the IMAGE\_PATH= option. The background image can be specified by using the BACKGROUND\_IMAGE= option. The image can also be justified by using the IMAGE\_JUST= option.

ods tagsets.tableeditor file="c:\\temp.html"
    options(background\_image="somepath.gif"
            image\_path="somepath.gif"
            image\_just="left"
            );

proc print data=sashelp.class;
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Freezing Row and Column Headers
-------------------------------

The below example uses dynamic positioning and specifies the page height and the page width by using the PAGEHEIGHT= and the PAGEWIDTH= options. This allows you to manage wide and long pages. If the output goes beyond the height and the width specified, scrollbars are added to the table. For a single table, the column headers and row headers can be frozen like in Excel when the the FROZEN\_ROWHEADERS= and FROZEN\_HEADERS= options are specified. These options can be added in conjunction with the PAGEHEIGHT= and the PAGEWIDTH= to generate a explicit page width and the page height. If these options are not specified, the page width and page height will be generated dynamically which will be the max width and height of the viewable area of the browser. For multiple tables, the FROZEN\_HEADERS\_ALL= can be specified. The FROZEN\_ROWHEADERS= option should only be applied to wide and not the very long tables. If you print the file, you get the complete table with the headers on each printed page.

ods tagsets.tableeditor file="c:\\temp.html"
    options(pageheight="300"
            pagewidth="35%"
            frozen\_headers="yes"
            frozen\_rowheaders="yes"
            );

proc print data=sashelp.class;
run;

* * *

Page Setup
----------

The below example modifies the printing properties such as the headers and footers and the orientation (which typically cannot be done programmatically) by using the PRINT\_HEADER=, PRINT\_FOOTER=, and ORIENTATION= options. The page breaks can be removed using the PAGEBREAK= option, and the printed scale of the output can be specified using the PRINT\_ZOOM= option. The PAGEBREAK= option can also specify how many tables to place on a page.

To prevent truncation or to get more information on a page, use either the ORIENTATION="LANDSCAPE" option, the PRINT\_ZOOM= option, or the FIT2PAGE= option. The FIT2PAGE="YES" option scales the output dynamically to fit on a printed page whether it is landscape or portrait. The page header is repeated automatically when the table breaks on a page. The margin options can also be specified. FIT2PAGE="YES" prevents truncation without having to specify a value. Special codes can be used for the headers and footers which allow you modify the presentation. The PAGEBREAK\_TOGGLE= option enables you to modify the page breaks dynamically. Here is the code available for the headers and footers in Internet Explorer:

Header

Code

Window title

&w

Page address (URL)

&u

Date in short format

&d

Date in long format

&D

Time in the format specified by Regional settings from the Control Panel

&t

Time in 24-hour format

&T

Current page number

&p

Total number of pages

&P

Right-aligned text (following &b)

&b

Centered text (between &b&b)

&b&b

A single ampersand (&)

&&

ods tagsets.tableeditor file="c:\\fit2page.html"
    style=styles.mystyle
    options(print\_header="&b testing header"
            print\_footer="testing footer"
            /\*print\_zoom="50%" \*/
            orientation="landscape"
            pagebreak="no"
            left\_margin=".5"
            right\_margin=".5"
            top\_margin="1"
            bottom\_margin="1"
            fit2page="yes"
        print\_dialog="yes"
        );

proc print data=sashelp.orsales(obs=20);
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Zoom
----

The ZOOM= option scales the output based on the value specified. the TABLE\_ZOOM= option specifies the zoom property for individual tables. In the below example, table 1 is scaled at 50%, table 2 is 75% and table 3 is 200%. ZOOM\_TOGGLE= option enables you to zoom the page interactively.

ods tagsets.tableeditor file="c:\\temp.html"
    options(/\* zoom="100%" \*/
            zoom\_table="50%, 75%, 200%"
            zoom\_toggle="no"
            );

proc print data=sashelp.class(obs=5);
run;

proc report data=sashelp.class(obs=5) nowd;
run;

proc print data=sashelp.air(obs=5);
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Sort
----

The SORT= option enables you to click on the column headers to sort the columns. The SORT\_ARROW\_COLOR= option allows you change the up and down arrow color. You can use the SORT\_IMAGE= and the SORT\_UNDERLINE= options to notify the user that the column headers can be sorted.

The DESCRIBE= option allows you to display the type of the field, whether character, numeric, or date. This allows you to see how this column will be sorted. In SAS 9.1, the REPORT procedure shows character for all of the columns; this has been enhanced for SAS 9.2. So if you are using PROC REPORT in SAS 9.1, you must set the data type to modify the default sorting for all fields as a character string. This can be done by using the DATA\_TYPE= option, specifying the desired type for each column. You can also set the type of the field within the procedure manually by using the TAGATTR= attribute. The valid types are Number, String, Date, None and Numberx (numbers formatted with the dollar sign , comma or percent).

ods tagsets.tableeditor file="c:\\temp.html"
    options(data\_type="String,String,Number,Number,Number"
            sort="yes"
            sort\_arrow\_color="green"
            sort\_image="temp.jpg"
            sort\_underline="no"
            describe="yes"
            );

proc print data=sashelp.class;
run;

proc report data=sashelp.class nowd;
  /\* define \_numeric\_ / style(header)={tagattr="type='String'"};\*/
run;

proc print data=sashelp.air;
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Excluding the Summary from the Sort
-----------------------------------

Summaries can be excluded by specifying HTMLCLASS="NoFilter" along with EXCLUDE\_SUMMARY="YES". This prevents the grand total or the summary from sorting in PROC REPORT.

ods tagsets.tableeditor file="c:\\exclude\_summary.html"
    options(sort="yes"
            sort\_arrow\_color="blue"
            exclude\_summary="yes"
            )
    style=styles.mystyle;


proc report data=sashelp.class(obs=5) nowd;
  rbreak after / summarize style={htmlclass="NoFilter"};
  title "Summary Excluded";
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Autofilters
-----------

Autofilters can be added using the AUTOFILTER="YES" option. The width for the filters can be modified by using the AUTOFILTER\_WIDTH= option. By default, the filter is as wide as the cell. Specific tables can be filtered by using the AUTOFILTER\_TABLE= option. An ending range on columns can be specified using the AUTOFILTER\_ENDCOL= option. To filter specific columns, the FILTER\_COLS= option can be specified with the list of columns separated by commas. The below code adds filters to the first table and gives it a default width so that it is not the width of the entire cell.

ods tagsets.tableeditor file="c:\\temp.html"
    options(autofilter="yes"
            autofilter\_width="7em"
            autofilter\_table="1"

            ) style=styles.mystyle ;

proc print data=sashelp.orsales(obs=100);
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Table of Contents with Tree View
--------------------------------

The tableeditor tagset also generates a compact table of contents for you by default. If you are not using the style STYLE.MYSTYLE, use the below PROC TEMPLATE code, which generates a collapsed table of contents. The plus or minus signs enable you to navigate down to the specific table or graph. The PROC TEMPLATE code defines the level of expansion. You also have the ability to add your own images using the OPEN\_IMAGE\_PATH=, CLOSED\_IMAGE\_PATH=, and the LEAF\_IMAGE\_PATH= options. The background color can be specified using the TOC\_BACKGROUND= option. The output can be expanded using the TOC\_EXPAND= option, and a "Print" button added by using the TOC\_PRINT= option.

ods tagsets.tableeditor
    file="c:\\temp.html"
    contents="c:\\temp1.html"
    frame="c:\\temp1.html"
    style=styles.mystyle

    options(/\*open\_image\_path="file.gif"
            closed\_image\_path="file.gif"
            leaf\_image\_path="file.gif"\*/
            toc\_background="white"
            toc\_expand="yes"
            toc\_print="yes"
            );

proc print data=sashelp.class;
run;

proc report data=sashelp.class nowd;
run;

ods tagsets.tableeditor close;

* * *

Interactive Options
-------------------

Interactive options include PAGEBREAK\_TOGGLE=, which enables you to toggle the page breaks interactively within the document. Also, there is the ZOOM\_TOGGLE= option which enables you to specify the zoom interactively. The STYLE\_SWITCH= option can be specified along with the CSS files of your choice. Any file that contains the name DEFAULT will be used as the default style; however, you then have the ability to choose from any of the others.

ods tagsets.tableeditor file="c:\\temp.html"
    style=styles.mystyle
    options(style\_switch="yes"
            pagebreak\_toggle="yes"
            zoom\_toggle="yes"
            )
    stylesheet=(url="default.css
                     astronomy.css
                     analysis.css
                     sasweb.css");

proc print data=sashelp.class;
run;

proc report data=sashelp.class nowd;
run;

ods tagsets.tableeditor close;

* * *

Informational Options
---------------------

These options are more informative in nature. They enable you to name the window by using the WINDOW\_TITLE= option, add a message when the page is loading by using the LOAD\_MSG= option, include another file (for example, PDF, RTF, HTML) to the document with the INCLUDE= option, or specify alert text or window status text.

ods tagsets.tableeditor file="c:\\temp.html"
    options(window\_title="the table editor"
            load\_msg="yes"
            include="c:\\temp.pdf"
            alert\_text="Confindential"
            window\_status="Wow! Now that's your style!"
            );

proc print data=sashelp.class;
run;

proc print data=sashelp.air;
run;

ods tagsets.tableeditor close;

* * *

Saving Data
-----------

A "Save As" button can be generated by specifying the SAVEAS= option. This adds a button on the page which allows the current HTML page to be saved. The DEFAULT\_FILE= option can specify a default filename to be used.

ods tagsets.tableeditor file="c:\\temp.html"
    options(saveas="yes"
            default\_file="c:\\\\temp.xls"
            );

proc print data=sashelp.class;
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Exporting Data
--------------

The EXCEL\_SAVE\_FILE= option saves the file as native a XLS, CSV, XML, TXT, DOC, or SLK file. Specify the appropriate extension of the file with the FILE\_FORMAT= option. You can also specify whether you want Excel to open this file or save it in the background. To save this file in the background without opening Excel, use the OPEN\_EXCEL="NO" option. There is also the EXCEL\_SAVE\_PROMPT= option, which prompts the user for a file to save. The EXCEL\_SAVE\_DIALOG= option opens a dialog box to save the file.

ods tagsets.tableeditor file="c:\\\\temp.html"
    options(excel\_save\_file="c:\\\\temp122.csv"
            file\_format="csv"
            open\_excel="no"
            quit="yes"
            );

proc print data=sashelp.class;
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output

* * *

Exporting to Excel
------------------

The EXCEL\_AUTOFILTER option enables autofilters. The EXCEL\_FROZEN\_HEADERS= option freezes the column headers in the Excel file. The EXCEL\_ORIENTATION= option controls the orientation of the sheet. You can name the sheets with the SHEET\_NAME= option. The table can be zoomed or scaled for the printed output by using the EXCEL\_ZOOM= or EXCEL\_SCALE= option. The AUTO\_FORMAT= option is used to supply one of Excels build-in formats

ods tagsets.tableeditor file="c:\\temp.html"
    style=styles.mystyle
    options(excel\_zoom="90"
            excel\_scale="90"
            excel\_autofilter="yes"
            excel\_frozen\_headers="yes"
            excel\_orientation="landscape"
            sheet\_name="first"
            auto\_format="color1"
            excel\_save\_file="c:\\\\temp.xls"
            );

proc print data=sashelp.class;
run;

proc report data=sashelp.class nowd;
run;

proc print data=sashelp.air;
run;

ods tagsets.tableeditor close;

* * *

Updating an Existing Excel Workbook
-----------------------------------

Tables from a web page can be inserted into a workbook as a worksheet using the Update\_Target= option which is responsible for the opening the file that will have the sheet inserted. The Sheet\_Name= option can be added to name tables moved from the web page into existing workbooks.

ods tagsets.tableeditor file="temp.html"
             options(update\_target="c:\\\\temp\\\\temp.xls"
                     sheet\_name="Table 1"
                     );

proc print data=sashelp.class;
run;


ods tagsets.tableeditor close;

* * *

Excel Pivot Tables
------------------

Pivot tables can be generated by specifying the range of the data to create the pivot table from using using the PTSOURCE\_RANGE= option. The pivot table will be write and the PTDEST\_RANGE= options. The pivot rows, columns, data, and page can be specified using the below options. To supply the position of more than one field to an option, separate the column number by commas.

ods tagsets.tableeditor file="c:\\temp.html"
    style=styles.mystyle
    options(excel\_orientation="landscape"
            sheet\_name="test"
            auto\_format="color2"
            ptsource\_range="b1:i5"
        pivotrow="5"
        pivotcol="2,3"
        pivotdata="7"
        pivotpage="1"
            );

proc print data=sashelp.orsales(obs=5);
  var year Quarter Product\_Line Product\_Category  Product\_Group
  Quantity  Profit Total\_Retail\_Price;
  title ;
run;

ods tagsets.tableeditor close;

The above example code produces the following output:

Example output